<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<title>春节快乐</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="theme-color" content="#000000">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="referrer" content="no-referrer-when-downgrade">
	<link rel="icon" type="image/png" href="assets/images/spring-lottery/firework-burst-icon-v2.png">
	<link rel="apple-touch-icon" href="assets/images/spring-lottery/firework-burst-icon-v2.png">
	<link href="css/spring-lottery/main.css" rel="stylesheet">
	<link href="css/spring-lottery/gift-modal.css" rel="stylesheet">
	<style>
		#newYearBg {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			z-index: 400;
			display: none;
			opacity: 0;
			transition: opacity 2s ease;
			background: #000;
		}
		#newYearBg img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			display: block;
		}
		.svg-symbols {
			height: 0;
			width: 0;
			position: absolute;
			visibility: hidden;
		}
		.stage-container {
			width: 1440px;
			height: 307px;
		}
		.canvas-container {
			background-color: transparent;
		}
		.type_words {
			font-size: 1.2rem;
			line-height: 1.5rem;
		}
		.menu__inner-wrap {
			opacity: 1;
		}
	</style>
</head>

<body>

	<audio id="audio_music" src="assets/music/spring_lottery/430d83be45af4abc8b0708691f9cd387.m4a" preload="auto" loop></audio>

	<div id="newYearBg">
		<img src="assets/images/spring-lottery/background.png" alt="">
	</div>

	<audio id="gift_audio" src="assets/music/spring_lottery/7585134800709684017.mp3" preload="auto"></audio>

	<div id="floatBalls" class="float-balls-container">
		<a href="lottery.html" class="float-ball lottery-ball">
			<span>抽奖<br>来真的</span>
		</a>
	</div>

	<div id="giftModal" class="gift-wrapper">
		<div class="gift-mask"></div>
		<div class="gift-card">
			<div class="gift-shine"></div>
			<div class="gift-content">
				<div class="gift-svg-container">
					<svg class="gift-svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
						<path d="M880.698823 406.885829l-107.064281 56.009741 0.863163-128.035965-0.287721-0.127876 140.535856-73.528769v127.87612zM914.74584 261.20296l-140.535856 73.528769-150.318379-72.345915 135.324904-70.20399z" fill="#5FCEFF"/>
						<path d="M774.497705 334.859605l-0.863163 128.035965-115.312292 60.357529 1.086947-128.163842-0.287721-0.159845 115.088508-60.197683z" fill="#FF4893"/>
						<path d="M623.891605 262.385814l150.318379 72.345915-115.088508 60.197683-147.441166-74.359964z" fill="#FF4893"/>
						<path d="M644.895258 141.415004l114.321251 50.76682-114.321251-50.76682z" fill="#5FCEFF"/>
						<path d="M759.216509 192.181824l-135.324904 70.20399-114.001561-54.858856 134.14205-66.495582 0.863164 0.383628z" fill="#FF4893"/>
						<path d="M659.409197 395.089257l-1.086947 128.163842-145.938622 76.342043v-127.87612l146.737848-76.78961z" fill="#5FCEFF"/>
						<path d="M659.121476 394.929412l-146.737848 76.78961-145.427117-76.086291 144.723799-75.063283zM644.032094 141.031376l-134.14205 66.495582-133.854329-64.417595 136.347913-60.517374z" fill="#5FCEFF"/>
						<path d="M623.891605 262.385814l-112.211295 58.183634-113.937623-57.448347 112.147357-55.594143z" fill="#FF4893"/>
						<path d="M512.383628 943.230246v-343.635104l145.938622-76.342043v0.255752l115.312292-60.32556v-0.287721l107.064281-56.009741-3.196903 349.581343-365.118292 194.7873-3.420686-1.918142z" fill="#FFB578"/>
						<path d="M512.383628 599.595142v343.635104l-3.420686 6.106084-361.697605-202.971371-3.196903-339.47913 109.302113 57.192595 115.02457 60.197684z" fill="#FFB578"/>
						<path d="M512.383628 471.719022v127.87612l-143.988511-75.319034-1.438606-128.643377z" fill="#5FCEFF"/>
						<path d="M511.68031 320.569448l-144.723799 75.063283-115.056539-60.197684v-0.031969l145.842715-72.281977zM509.890044 207.526958l-112.147357 55.594143-136.667603-68.957197 2.589491-1.182854 112.37114-49.871687z" fill="#FF4893"/>
						<path d="M261.075084 194.163904l136.667603 68.957197-145.842715 72.281977v0.031969l-141.878555-74.232087z" fill="#5FCEFF"/>
						<path d="M366.956511 395.632731l1.438606 128.643377-115.02457-60.197684-1.470575-128.643377z" fill="#FF4893"/>
						<path d="M144.068434 406.885829l-34.047017-17.806749v-127.87612l141.878555 74.232087 1.470575 128.643377z" fill="#5FCEFF"/>
					</svg>
				</div>
				<h2 class="gift-title">春节快乐</h2>
				<p class="gift-text">为您精心准备了<br>一份特别的春节礼物</p>
				<button id="gift-btn" class="gift-btn">开启礼物</button>
			</div>
		</div>
	</div>

	<div class="svg-symbols">
		<svg xmlns="http://www.w3.org/2000/svg">
			<symbol id="icon-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></symbol>
			<symbol id="icon-pause" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></symbol>
			<symbol id="icon-close" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></symbol>
			<symbol id="icon-settings" viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59-1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></symbol>
			<symbol id="icon-sound-on" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"></path></symbol>
			<symbol id="icon-sound-off" viewBox="0 0 24 24"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"></path></symbol>
		</svg>
	</div>

	<div class="container">
		<div id="bg-warp"></div>
		<div class="stage-container">
			<div class="page_two hide">
				<div id="text" style="display:none;">往事清零爱恨随意，2024希望你活的开心，不用回头不再将就，过去所有的遗憾都是2024的惊喜，遇见你都是天意，拥有你都是幸运2024，愿自己有能力爱你！

世界这么大而我真正想落脚的地方是你的身旁
如果你是三
那我一定是九你知道为什么吗?
因为我除了你还是你</div>
				<div class="type_words" id="contents"></div>
			</div>
			<div class="canvas-container">
				<canvas id="trails-canvas" width="2880" height="614" style="touch-action: none; width: 1440px; height: 307px;"></canvas>
				<canvas id="main-canvas" width="2880" height="614" style="touch-action: none; width: 1440px; height: 307px;"></canvas>
			</div>

			<div class="menu hide">
				<div class="menu__inner-wrap">
					<div class="btn btn--bright close-menu-btn">
						<svg fill="white" width="24" height="24"><use href="#icon-close"></use></svg>
					</div>
					<div class="menu__header">设置</div>
					<form>
						<div class="form-option form-option--select">
							<label class="shell-type-label">烟花类型</label>
							<select class="shell-type">
								<option value="Random">Random</option>
								<option value="Crackle">Crackle</option>
								<option value="Crossette">Crossette</option>
								<option value="Crysanthemum">Crysanthemum</option>
								<option value="Falling Leaves">Falling Leaves</option>
								<option value="Floral">Floral</option>
								<option value="Ghost">Ghost</option>
								<option value="Horse Tail">Horse Tail</option>
								<option value="Palm">Palm</option>
								<option value="Ring">Ring</option>
								<option value="Strobe">Strobe</option>
								<option value="Willow">Willow</option>
							</select>
						</div>
						<div class="form-option form-option--select">
							<label class="shell-size-label">烟花大小</label>
							<select class="shell-size">
								<option value="0">3"</option>
								<option value="1">4"</option>
								<option value="2">6"</option>
								<option value="3">8"</option>
								<option value="4">12"</option>
								<option value="5">16"</option>
							</select>
						</div>
						<div class="form-option form-option--select">
							<label class="quality-ui-label">画质</label>
							<select class="quality-ui">
								<option value="1">低</option>
								<option value="2">正常</option>
								<option value="3">高</option>
							</select>
						</div>
						<div class="form-option form-option--select">
							<label class="sky-lighting-label">天空照明</label>
							<select class="sky-lighting">
								<option value="0">无</option>
								<option value="1">暗淡</option>
								<option value="2">正常</option>
							</select>
						</div>
						<div class="form-option form-option--select">
							<label class="scaleFactor-label">规模</label>
							<select class="scaleFactor">
								<option value="0.50">50%</option>
								<option value="0.62">62%</option>
								<option value="0.75">75%</option>
								<option value="0.90">90%</option>
								<option value="1.00">100%</option>
								<option value="1.50">150%</option>
								<option value="2.00">200%</option>
							</select>
						</div>
						<div class="form-option form-option--checkbox">
							<label class="auto-launch-label">自动发射</label>
							<input class="auto-launch" type="checkbox">
						</div>
						<div class="form-option form-option--checkbox form-option--finale-mode">
							<label class="finale-mode-label">结局模式</label>
							<input class="finale-mode" type="checkbox">
						</div>
						<div class="form-option form-option--checkbox">
							<label class="hide-controls-label">隐藏控制器</label>
							<input class="hide-controls" type="checkbox">
						</div>
						<div class="form-option form-option--checkbox form-option--fullscreen">
							<label class="fullscreen-label">全屏</label>
							<input class="fullscreen" type="checkbox">
						</div>
						<div class="form-option form-option--checkbox">
							<label class="long-exposure-label">打开快门</label>
							<input class="long-exposure" type="checkbox">
						</div>
					</form>
				</div>
			</div>
		</div>
		<div class="help-modal">
			<div class="help-modal__overlay"></div>
			<div class="help-modal__dialog">
				<div class="help-modal__header"></div>
				<div class="help-modal__body"></div>
				<button type="button" class="help-modal__close-btn">关闭</button>
			</div>
		</div>
	</div>

	<script>
		(function() {
			function initTransparent() {
				var containers = document.querySelectorAll('.container, .stage-container, .canvas-container');
				containers.forEach(function(el) {
					el.style.backgroundColor = 'transparent';
				});
				var canvases = document.querySelectorAll('canvas');
				canvases.forEach(function(el) {
					el.style.backgroundColor = 'transparent';
				});
			}
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', initTransparent);
			} else {
				initTransparent();
			}
			setTimeout(initTransparent, 100);
		})();

		function handleGiftModalClose() {
			var modal = document.getElementById('giftModal');
			var bg = document.getElementById('newYearBg');
			var audio = document.getElementById('gift_audio');
			var floatBalls = document.getElementById('floatBalls');

			window.isImageBackground = true;

			var containers = document.querySelectorAll('.container, .stage-container, .canvas-container');
			containers.forEach(function(el) {
				el.style.backgroundColor = 'transparent';
			});

			if (bg) {
				bg.style.display = 'block';
			}

			modal.style.transition = 'all 0.8s cubic-bezier(0.22, 1, 0.36, 1)';
			modal.style.opacity = '0';
			modal.style.transform = 'translateY(-30px) scale(1.02)';
			setTimeout(function() { modal.remove(); }, 800);

			setTimeout(function() {
				if (floatBalls) {
					floatBalls.classList.add('show');
				}
			}, 800);

			document.documentElement.style.transition = 'background-color 1s ease';
			document.documentElement.style.backgroundColor = '#000';
			document.body.style.transition = 'background-color 1s ease';
			document.body.style.backgroundColor = '#000';

			setTimeout(function() {
				if (bg) {
					setTimeout(function() { bg.style.opacity = '1'; }, 100);
				}
			}, 500);

			setTimeout(function() {
				if (audio) audio.play().catch(function(e) { console.log('音频播放需要用户交互'); });
			}, 1000);

			setTimeout(function() {
				if (typeof togglePause === 'function') {
					togglePause(false);
				}
				
				if (typeof updateConfig === 'function') {
					updateConfig({ autoLaunch: true, hideControls: true });
				}
				
				if (typeof launchShellFromConfig === 'function') {
					for(var i=0; i<8; i++) setTimeout(launchShellFromConfig, i * 250);
				}
			}, 2500);
		}

		document.getElementById('gift-btn').addEventListener('click', handleGiftModalClose);
	</script>
	<script src="javascript/spring-lottery/fireworks/fireworks.js"></script>
	<script src="javascript/spring-lottery/core/stage.js"></script>
	<script src="javascript/spring-lottery/app.js"></script>
</body>
</html>
